import{r as E}from"./index.CVf8TyFT.js";function S({selector:f}){return E.useEffect(()=>{const d=Array.from(document.querySelectorAll(f));if(!d.length)return;const u=new Map;d.forEach(t=>{const e=t.getAttribute("data-api-src");e&&(u.has(e)||u.set(e,[]),u.get(e).push(t))});function b(t,e){return e.split(".").reduce((r,n)=>r?r[n]:void 0,t)}function A(t,e){try{return Intl.NumberFormat(void 0,{minimumFractionDigits:e,maximumFractionDigits:e}).format(t)}catch(r){return String(t.toFixed?t.toFixed(e):t)}}function y(t){const e=Number(String(t||"").replace(/[^0-9.-]/g,""));return isNaN(e)?0:e}function N(t){return 1-Math.pow(1-t,3)}function h(t,e,r){const n=!t.getAttribute("data-initialized"),i=n?0:y(t.getAttribute("data-prev")||t.textContent||"0"),o=800,c=performance.now();n&&t.setAttribute("data-initialized","1");function a(s){const m=Math.min(1,(s-c)/o),l=N(m),v=i+(e-i)*l;t.textContent=A(v,r),m<1?requestAnimationFrame(a):t.setAttribute("data-prev",String(e))}requestAnimationFrame(a)}const p=new AbortController;u.forEach(async(t,e)=>{try{const r=await fetch(e,{signal:p.signal,cache:"no-store"});if(!r.ok)return;const n=await r.json();t.forEach(i=>{const o=i.getAttribute("data-api-path")||"",c=b(n,o);if(typeof c=="number"){const a=i.querySelector("[data-metric]")||i,s=(i.getAttribute("data-decimals")||"").trim(),m=s!==""&&!isNaN(Number(s))?Number(s):/usdt/i.test(o)?8:0;h(a,c,m)}})}catch(r){}});const g=()=>{document.visibilityState==="visible"&&u.forEach((t,e)=>{fetch(e,{cache:"no-store"}).then(r=>r.ok?r.json():null).then(r=>{r&&t.forEach(n=>{const i=n.getAttribute("data-api-path")||"",o=b(r,i);if(typeof o=="number"){const c=n.querySelector("[data-metric]")||n,a=(n.getAttribute("data-decimals")||"").trim(),s=a!==""&&!isNaN(Number(a))?Number(a):/usdt/i.test(i)?8:0;h(c,o,s)}})}).catch(()=>{})})};return document.addEventListener("visibilitychange",g),()=>{p.abort(),document.removeEventListener("visibilitychange",g)}},[f]),null}export{S as default};
