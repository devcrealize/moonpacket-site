import{r as j}from"./index.CVf8TyFT.js";function R({src:w,selector:y,intervalMs:v,sentFromLabel:N,claimedLabel:B,totalLabel:C,progressLabel:D}){return j.useEffect(()=>{const i=document.querySelector(y);if(!i)return;let r=[],c=0,m=null;function b(t){return/TON Builders/i.test(t)?"https://t.me/tonbuilders":/Meme Rocket/i.test(t)?"https://t.me/memerocket":/Moon Club A/i.test(t)?"https://t.me/mooncluba":/Moonpacket/i.test(t)?"https://t.me/moonpacket":""}function k(t){const e=["Alice","Bob","Carol","Dave","Erin","Frank","Grace","Heidi","Ivan","Judy","Ken","Lily","Ming","Nina","Owen","Paul","Queenie","Ray","Sara","Tom","Una","Vic","Will","Xena","Yao","Zack"],a=["Moon Club A","TON Builders","Meme Rocket","Moonpacket 總群"],o=["USDT","ETH","SOL","TON"],l=Date.now(),p=[];for(let s=0;s<t;s++){const f=+(Math.random()*200+50).toFixed(2),_=Math.floor(Math.random()*100);p.push({id:`mock_${s}`,user:e[s%e.length],group:a[s%a.length],link:b(a[s%a.length]),amount:+(Math.random()*12+1).toFixed(2),ccy:o[s%o.length],ts:new Date(l-s*2e4).toISOString(),total_amount:f,claimed_count:_,total_count:100})}return p}function I(){return'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><rect x="3" y="4" width="18" height="16" rx="3" fill="#E32521"/><path d="M4 8l8 4 8-4" fill="#FFBA00"/></svg>'}function L(t){const e='width="14" height="14" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"';return t==="USDT"?`<svg ${e}><circle cx="12" cy="12" r="10" fill="#26A17B"/><path d="M7 7h10v2h-4v3.5c2.5.2 4 .7 4 1.5s-2.9 1.5-5 1.5-5-.7-5-1.5c0-.8 1.5-1.3 4-1.5V9H7V7z" fill="#fff"/></svg>`:t==="ETH"?`<svg ${e}><circle cx="12" cy="12" r="10" fill="#627EEA"/><path d="M12 4l5 8-5 3-5-3 5-8zm0 16l5-7-5 3-5-3 5 7z" fill="#fff"/></svg>`:t==="SOL"?`<svg ${e}><circle cx="12" cy="12" r="10" fill="#14F195"/><path d="M7 9l2-2h8l-2 2H7zm0 4l2-2h8l-2 2H7zm0 4l2-2h8l-2 2H7z" fill="#0B1F1A"/></svg>`:`<svg ${e}><circle cx="12" cy="12" r="10" fill="#0098EA"/><path d="M12 6c3 0 5 1.5 5 3.7 0 .9-.3 1.7-.8 2.4L12 18l-4.2-5.9c-.5-.7-.8-1.5-.8-2.4C7 7.5 9 6 12 6z" fill="#fff"/></svg>`}function $(t){try{return new Intl.NumberFormat(void 0).format(Number(t||0))}catch(e){return String(t||0)}}function h(t){var e,a,o;const l=document.createElement("div");l.className="col-span-1 sm:col-span-2 lg:col-span-3 p-2 rounded-lg bg-white ring-1 ring-black/5 text-sm",l.style.transition="transform .28s ease, opacity .28s ease",l.style.transform="translateY(-12px)",l.style.opacity="0";const p=t&&t.ccy?String(t.ccy):"USDT";function s(n,u){var d=Number(n==null?0:n),H={minimumFractionDigits:8,maximumFractionDigits:8};try{return new Intl.NumberFormat(void 0,H).format(d)}catch(x){return String(d.toFixed(8))}}const f=t&&(t.link||t.group_link)||b(t&&t.group?String(t.group):"");l.innerHTML=`
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-3 leading-[1.5] text-[13px] sm:text-sm">
          <div class="min-w-0 flex flex-wrap sm:flex-nowrap items-center overflow-hidden">
            <span class="inline-flex items-center gap-1 font-semibold whitespace-nowrap sm:w-[96px]">${I()} ${t.user||"用戶"}</span>
            <span class="hidden sm:inline mx-2 text-gray-400 dark:text-gray-600">|</span>
            <span class="text-textSubtle whitespace-nowrap sm:w-[180px]">${N||"發送群："}${f?`<a href="${f}" target="_blank" rel="noopener" class="underline hover:opacity-80">${t.group||"moonpacket 群"}</a>`:t.group||"moonpacket 群"}</span>
            <span class="hidden sm:inline mx-2 text-gray-400 dark:text-gray-600">|</span>
            <span class="text-textSubtle whitespace-nowrap sm:w-[220px]">${C||"總額"} <span class="num">${s((e=t.total_amount)!=null?e:t.amount*100)}</span> ${p}</span>
            <span class="hidden sm:inline mx-2 text-gray-400 dark:text-gray-600">|</span>
            <span class="text-textSubtle whitespace-nowrap sm:w-[120px]">${D||"已領取"} <span class="font-semibold">${$((a=t.claimed_count)!=null?a:0)}</span>/<span class="font-semibold">${$((o=t.total_count)!=null?o:100)}</span></span>
          </div>
          <div class="text-right whitespace-nowrap flex items-center sm:justify-end">
            <span class="inline-flex items-center gap-1 sm:w-[240px] justify-end">${L(p)} <span>${B||"領取"} <span class="num">${s(t.amount)}</span> ${p}</span></span>
            <span class="hidden sm:inline mx-2 text-gray-400 dark:text-gray-600">|</span>
            <span class="text-xs text-textSubtle sm:w-[64px] text-right">${new Date(t.ts||Date.now()).toLocaleTimeString()}</span>
          </div>
        </div>
      `;const A=Array.from(i.children).map(n=>n.getBoundingClientRect().top);i.prepend(l);const E=Array.from(i.children);for(let n=1;n<E.length;n++){const u=E[n],d=u.getBoundingClientRect().top,x=A[n-1]-d;Math.abs(x)>.5&&(u.style.willChange="transform",u.style.transition="transform .28s ease",u.style.transform=`translateY(${x}px)`,requestAnimationFrame(()=>{u.style.transform="translateY(0)"}))}requestAnimationFrame(()=>{l.style.transform="translateY(0)",l.style.opacity="1"});const z=20;for(;i.children.length>z;){const n=i.lastElementChild;if(n&&n.parentNode)n.parentNode.removeChild(n);else break}}function O(){if(!r.length)return;const t=1+Math.floor(Math.random()*3);for(let e=0;e<t;e++)h(r[c%r.length]),c++}async function M(){try{const t=await fetch(w,{cache:"no-store"});if(!t.ok)return;const e=await t.json();r=e&&e.items||[],r.length>20&&(r=r.slice(0,30)),c=0,i.innerHTML="";let a=Math.min(20,r.length);a||(r=k(30),a=20);for(let o=0;o<a;o++)h(r[o]);typeof window!="undefined"&&console.debug("[Waterfall] initial rendered",a),c=a}catch(t){r=k(30),c=0,i.innerHTML="";for(let e=0;e<20;e++)h(r[e]);typeof window!="undefined"&&console.debug("[Waterfall] fallback rendered 20 from mock"),c=20}}M(),m=setInterval(async()=>{await M()},v||6e4);const S=[1100,1500,900,1400,1200];let g=0,T=null;function F(){T=setTimeout(()=>{O(),g=(g+1)%S.length,F()},S[g])}return F(),()=>{m&&clearInterval(m),clearInterval(T)}},[w,y,v]),null}export{R as default};
